<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Crux — Web3 Social dApp</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <script type="module">
   import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@6.8.1/+esm";

// Initialize the coin sound effect
const coinSound = new Audio('./coin.mp3'); // Make sure this path is correct

function onWalletConnected(account) {
  const popup = document.getElementById("popup");
  const continueBtn = document.getElementById("continueBtn");
  const addressDisplay = document.getElementById("walletAddress");

  // Show connected account in popup
  addressDisplay.textContent = `Connected wallet: ${account}`;

  // Show the popup
  popup.classList.remove("hidden");
  continueBtn.focus();

  // Play retro coin sound
  coinSound.play().catch((e) => {
    console.warn("Sound playback failed:", e);
  });

  // Continue button click handler
  continueBtn.addEventListener("click", () => {
    window.location.href = "./index.html"; // Redirect to your dApp page
  });

  // Pressing Enter key also continues
  window.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && !popup.classList.contains("hidden")) {
      window.location.href = "./index.html";
    }
  });
}

window.onload = () => {
  const btn = document.getElementById("connectBtn");

  btn.onclick = async () => {
    if (!window.ethereum) {
      alert("Please install MetaMask!");
      return;
    }

    try {
      const provider = new ethers.BrowserProvider(window.ethereum);
      const accounts = await provider.send("eth_requestAccounts", []);

      if (!accounts || accounts.length === 0) {
        alert("No account found!");
        return;
      }

      const account = accounts[0];
      btn.innerText = "☑ " + account.slice(0, 6) + "..." + account.slice(-4);

      // Call onWalletConnected with the connected account
      onWalletConnected(account);

    } catch (error) {
      console.error("Connection failed", error);
      alert("Connection failed!");
    }
  };
};

     const cursor = document.getElementById("cursor");
let mouseX = 0, mouseY = 0;
let currentX = 0, currentY = 0;

window.addEventListener("mousemove", (e) => {
  mouseX = e.clientX;
  mouseY = e.clientY;
});

function animate() {
  currentX += (mouseX - currentX) * 0.15;
  currentY += (mouseY - currentY) * 0.15;
  cursor.style.left = currentX + "px";
  cursor.style.top = currentY + "px";
  requestAnimationFrame(animate);
}

animate();

  </script>

  <style>
    #cursor {
      transform: translate(-50%, -50%);
      transition: transform 0.1s ease-out;
    }

    @keyframes zoomPan {
      0% {
        background-position: top left;
        background-size: 110%;
      }
      50% {
        background-position: bottom right;
        background-size: 130%;
      }
      100% {
        background-position: bottom left;
        background-size: 110%;
      }
    }

    .animated-bg {
      animation: zoomPan 40s ease-in-out infinite;
      background-repeat: no-repeat;
      background-size: 110%;
      background-position: top left;
    }
    
  </style>
</head>

<body class="relative min-h-screen bg-black text-white flex flex-col items-center justify-center px-4 text-center overflow-hidden">
  <!-- Background -->
  <div class="absolute inset-0 z-0 animated-bg opacity-20" style="background-image: url('./ethpic.jpg');"></div>

  <!-- Content -->
  <main class="z-10 max-w-xl">
    <h1 class="text-4xl md:text-5xl font-extrabold mb-4 tracking-tight">Crux</h1>
    <p class="text-gray-300 mb-8 text-lg">
      A decentralized social network powered by Ethereum — create, share, and connect without limits.
    </p>
    <button id="connectBtn" class="bg-[#6b46c1] text-white px-6 py-3 rounded-xl text-lg font-medium hover:text-black hover:bg-gray-200 transition">
      Connect Wallet
    </button>
  </main>

  <!-- Modal -->
  <div id="popup" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 hidden">
  <div class="bg-gray-900 text-white p-6 rounded-2xl shadow-2xl w-[90%] max-w-sm text-center">
    <h2 class="text-2xl font-bold mb-4">✅ Connected Successfully</h2>
    <p class="mb-2 text-gray-300">You're now ready to explore Crux.</p>
    <p class="mb-6 text-purple-400 text-sm" id="walletAddress"></p>
    <button id="continueBtn" class="bg-purple-600 hover:bg-purple-700 px-6 py-2 rounded-lg transition-all">
      Continue
    </button>
  </div>
</div>


  <!-- Cursor -->
  <div id="cursor" class="pointer-events-none fixed w-5 h-5 rounded-full bg-purple-600 shadow-lg z-50"></div>
</body>
</html>
